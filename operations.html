

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Operation of the MagAO-X instrument &mdash; MagAO-X Instrument Handbook  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/stats.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data reduction and calibration" href="reduction.html" />
    <link rel="prev" title="Planning your observations" href="planning.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/magao-x_logo_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="capabilities.html">Instrument description and capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="planning.html">Planning your observations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Operation of the MagAO-X instrument</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting-a-magao-x-app-that-won-t-start">Troubleshooting a MagAO-X app that won’t start</a></li>
<li class="toctree-l3"><a class="reference internal" href="#edt-framegrabber-problems-camwfs-and-camlowfs">EDT Framegrabber Problems (camwfs and camlowfs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#killing-indi-zombies">killing indi zombies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#difficulties-with-nvidia-proprietary-drivers">Difficulties with NVIDIA proprietary drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-new-user-or-developer-account">Adding a new user or developer account</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#add-a-user-sh"><code class="docutils literal notranslate"><span class="pre">add_a_user.sh</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-a-developer-sh"><code class="docutils literal notranslate"><span class="pre">add_a_developer.sh</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reduction.html">Data reduction and calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="apps/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendices/index.html">Appendices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MagAO-X Instrument Handbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Operation of the MagAO-X instrument</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/operations.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="operation-of-the-magao-x-instrument">
<h1>Operation of the MagAO-X instrument<a class="headerlink" href="#operation-of-the-magao-x-instrument" title="Permalink to this headline">¶</a></h1>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="troubleshooting-a-magao-x-app-that-won-t-start">
<h3>Troubleshooting a MagAO-X app that won’t start<a class="headerlink" href="#troubleshooting-a-magao-x-app-that-won-t-start" title="Permalink to this headline">¶</a></h3>
<p>The typical MagAO-X app is started by <code class="docutils literal notranslate"><span class="pre">magaox</span> <span class="pre">startup</span></code> based on a line in a config file in <code class="docutils literal notranslate"><span class="pre">/opt/MagAOX/config/proclist_$MAGAOX_ROLE.txt</span></code>. This proclist determines which application to start and which config file from <code class="docutils literal notranslate"><span class="pre">/opt/MagAOX/config</span></code> should be supplied as the <code class="docutils literal notranslate"><span class="pre">-n</span></code> option (see <a class="reference external" href="#standard-options">Standard options</a>). It also uses <code class="docutils literal notranslate"><span class="pre">sudo</span></code> to run the process as user <code class="docutils literal notranslate"><span class="pre">xsup</span></code>, regardless of which user called <code class="docutils literal notranslate"><span class="pre">magaox</span> <span class="pre">startup</span></code>.</p>
<p>Many, if not all, MagAO-X apps are intended to run “forever” (i.e until shutdown). Obviously, if the process exits early, that’s cause for concern. To interrogate the list of running processes, use <code class="docutils literal notranslate"><span class="pre">magaox</span> <span class="pre">status</span></code>. To attempt a restart, you can attach to the <code class="docutils literal notranslate"><span class="pre">tmux</span></code> session that’s the parent of the process in question with <code class="docutils literal notranslate"><span class="pre">magaox</span> <span class="pre">inspect</span> <span class="pre">PROCNAME</span></code> (where <code class="docutils literal notranslate"><span class="pre">PROCNAME</span></code> is the name of the failed process).</p>
<p>For example, if <code class="docutils literal notranslate"><span class="pre">trippLitePDU</span></code> is started by <code class="docutils literal notranslate"><span class="pre">magaox</span> <span class="pre">startup</span></code> with config specified by <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">pdu0</span></code> and there’s a syntax error in <code class="docutils literal notranslate"><span class="pre">/opt/MagAOX/config/pdu0.conf</span></code> preventing startup, you can attach to the tmux session with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>yourlogin$ magaox inspect pdu0
</pre></div>
</div>
<p>The errors before exit, if any, will be in the log. The last few lines of the log are shown in <code class="docutils literal notranslate"><span class="pre">magaox</span> <span class="pre">status</span></code> output, or you can do <code class="docutils literal notranslate"><span class="pre">logdump</span> <span class="pre">-f</span> <span class="pre">pdu0</span></code>.</p>
<p>The command that started the app will be of the form <code class="docutils literal notranslate"><span class="pre">/opt/MagAOX/bin/$appName</span> <span class="pre">-n</span> <span class="pre">$configName</span></code>. You can use the up-arrow key in the tmux session to retrieve it from the shell history and try to relaunch once you’ve corrected whatever error was preventing startup.</p>
</div>
<div class="section" id="edt-framegrabber-problems-camwfs-and-camlowfs">
<h3>EDT Framegrabber Problems (camwfs and camlowfs)<a class="headerlink" href="#edt-framegrabber-problems-camwfs-and-camlowfs" title="Permalink to this headline">¶</a></h3>
<p>The EDT PCIe framegrabber occassionally stops responding.  The main symptom of this is no data from <code class="docutils literal notranslate"><span class="pre">camwfs</span></code>, and no response on the serial over camera link.  This has not yet been observed on <code class="docutils literal notranslate"><span class="pre">camlowfs</span></code> (which does not use serial over C.L.).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">camwfs</span></code> (or any EDT camera) stops responding on serial, first shutdown the controlling application.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ magaox inspect camwfs
&lt;Ctrl-C&gt;
</pre></div>
</div>
<p>then do these steps as root:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ modprobe -r edt
$ cd /opt/EDTpdv
$ ./edt_load
</pre></div>
</div>
<p>This will reset the kernel module and restore operation.  Now restart the controlling application by returning to the tmux session, up-arrow to find the command, and press enter.</p>
</div>
<div class="section" id="killing-indi-zombies">
<h3>killing indi zombies<a class="headerlink" href="#killing-indi-zombies" title="Permalink to this headline">¶</a></h3>
<p>If the <code class="docutils literal notranslate"><span class="pre">indiserver</span></code> crashes uncleanly (itself a subprocess of <code class="docutils literal notranslate"><span class="pre">xindiserver</span></code>), the associated <code class="docutils literal notranslate"><span class="pre">xindidriver</span></code> processes may become orphans.  This will prevent <code class="docutils literal notranslate"><span class="pre">xindiserver</span></code> from starting gain until these processes have been killed.  The following shell command will kill them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ kill $(ps -elf | awk &#39;{if ($5 == 1){print $4&quot; &quot;$5&quot; &quot;$15}}&#39; | grep MagAOX/drivers | awk &#39;{print $1}&#39;)
</pre></div>
</div>
<p>To check if any remain use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ps -elf | awk &#39;{if ($5 == 1){print $4&quot; &quot;$5&quot; &quot;$15}}&#39; | grep MagAOX/drivers
</pre></div>
</div>
</div>
</div>
<div class="section" id="difficulties-with-nvidia-proprietary-drivers">
<h2>Difficulties with NVIDIA proprietary drivers<a class="headerlink" href="#difficulties-with-nvidia-proprietary-drivers" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>When installing, ensure you have <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">set-default</span> <span class="pre">multi-user.target</span></code> and a display is connected <strong>only</strong> to the VGA header provided by the motherboard</p></li>
<li><p>If NVIDIA graphical output did work, and now doesn’t: Your kernel may have been updated, requiring a rebuild of the NVIDIA driver. Having <code class="docutils literal notranslate"><span class="pre">dkms</span></code> installed <em>should</em> prevent needing to do this, but an uninstall and reinstall over SSH will also remedy it.</p></li>
<li><p>Runfile installs can be uninstalled with <code class="docutils literal notranslate"><span class="pre">/usr/local/cuda/bin/cuda-uninstaller</span></code></p></li>
</ol>
</div>
<div class="section" id="adding-a-new-user-or-developer-account">
<h2>Adding a new user or developer account<a class="headerlink" href="#adding-a-new-user-or-developer-account" title="Permalink to this headline">¶</a></h2>
<p>User accounts on the RTC, ICC, and AOC machines are members of <code class="docutils literal notranslate"><span class="pre">magaox</span></code>. Developer accounts are additionally members of <code class="docutils literal notranslate"><span class="pre">magaox-dev</span></code> and <code class="docutils literal notranslate"><span class="pre">wheel</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">/opt/MagAOX/source/MagAOX/setup/</span></code> contains scripts to help you remember which groups and what permissions the <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> folder should have.</p>
<div class="section" id="add-a-user-sh">
<h3><code class="docutils literal notranslate"><span class="pre">add_a_user.sh</span></code><a class="headerlink" href="#add-a-user-sh" title="Permalink to this headline">¶</a></h3>
<p>Creates a new user account in the group <code class="docutils literal notranslate"><span class="pre">magaox</span></code>, creates <code class="docutils literal notranslate"><span class="pre">.ssh</span></code> (<code class="docutils literal notranslate"><span class="pre">u=rwx,g=r,o=r</span></code>), and <code class="docutils literal notranslate"><span class="pre">.ssh/authorized_keys</span></code> (<code class="docutils literal notranslate"><span class="pre">u=rw,g=,o=</span></code>).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ /opt/MagAOX/source/MagAOX/setup/add_a_user.sh klmiller
</pre></div>
</div>
</div>
<div class="section" id="add-a-developer-sh">
<h3><code class="docutils literal notranslate"><span class="pre">add_a_developer.sh</span></code><a class="headerlink" href="#add-a-developer-sh" title="Permalink to this headline">¶</a></h3>
<p>Just like <code class="docutils literal notranslate"><span class="pre">add_a_user.sh</span></code> (in fact, uses it). Additionally adds the new account to the <code class="docutils literal notranslate"><span class="pre">wheel</span></code> (RTC/ICC) or <code class="docutils literal notranslate"><span class="pre">sudo</span></code> (AOC) group and <code class="docutils literal notranslate"><span class="pre">magaox-dev</span></code> groups.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reduction.html" class="btn btn-neutral float-right" title="Data reduction and calibration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="planning.html" class="btn btn-neutral float-left" title="Planning your observations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Extreme Wavefront Control Lab, The University of Arizona

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>